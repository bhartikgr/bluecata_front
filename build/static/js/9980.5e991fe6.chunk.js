"use strict";(self.webpackChunkamourette=self.webpackChunkamourette||[]).push([[9980],{4500:(e,s,a)=>{a.r(s),a.d(s,{default:()=>N});var t=a(5043),l=a(1462),o=a(3216),n=a(5700),i=a(6990),r=a(4297),c=(a(4220),a(793)),d=a(5284),m=a(4282),u=a(6213),p=a(4117),g=a(2862),h=a(9564),x=a(3538),j=a(494),v=(a(228),a(2074)),f=a(3996),y=a(579);function N(){const e=(0,o.Zp)(),[s,a]=(0,t.useState)(!1),[N,b]=(0,t.useState)(""),[S,w]=(0,t.useState)(""),[_,C]=(0,t.useState)(""),[A,k]=(0,t.useState)(""),[I,R]=(0,t.useState)([]),[E,O]=(0,t.useState)(!1),[$,T]=(0,t.useState)(!1),[L,F]=(0,t.useState)(!0),[q,J]=(0,t.useState)(""),[U,M]=(0,t.useState)(""),[B,Y]=(0,t.useState)(""),[P,D]=(0,t.useState)(!1),[K,z]=(0,t.useState)(!1),[H,W]=(0,t.useState)([]),[V,X]=(0,t.useState)(!1),[Z,G]=(0,t.useState)(1),[Q,ee]=(0,t.useState)([]),[se,ae]=(0,t.useState)([]),[te,le]=(0,t.useState)([]),[oe,ne]=(0,t.useState)([]),[ie,re]=(0,t.useState)(null),[ce,de]=(0,t.useState)(!1),[me,ue]=(0,t.useState)(""),[pe,ge]=(0,t.useState)(""),[he,xe]=(0,t.useState)(""),[je,ve]=(0,t.useState)(null),[fe,ye]=(0,t.useState)(""),[Ne,be]=(0,t.useState)(""),[Se,we]=(0,t.useState)(""),{id:_e,image_url:Ce}=(0,o.g)(),[Ae,ke]=(decodeURIComponent(Ce),(0,t.useState)(0)),Ie=localStorage.getItem("userLogin"),Re=Ie?JSON.parse(Ie):null;(0,t.useEffect)((()=>(document.body.style.overflowY=V?"hidden":"auto",()=>{document.body.style.overflowY="auto"})),[V]);var Ee="https://backend.amourette.no/api/members/";(0,t.useEffect)((()=>{const e=localStorage.getItem("userLogin"),s=e?JSON.parse(e):null;re(s)}),[]),(0,t.useEffect)((()=>{_e&&Oe(_e)}),[_e]);const Oe=async e=>{const s=localStorage.getItem("userLogin");let a={user_id:(s?JSON.parse(s):null).id,album_id:e};try{var t=(await u.A.post(Ee+"getpreviewtemediaalbum",a,{headers:{Accept:"application/json","Content-Type":"application/json"}})).data;if(t.results.length>0){M(t.results[0].m_id),ge(t.results[0].name),ye(t.results[0].user_id),k(t.results[0].name);let e=[],s=[];t.results.forEach((e=>{try{const a=JSON.parse(e.images);Array.isArray(a)&&a.forEach((a=>{const t={url:a,id:e.m_id,type:null,cover_image:e.cover_image};t&&s.push(t)}))}catch(he){console.error("Error parsing images JSON:",he)}})),le(s),ne(e),ke(0)}}catch(l){l.response||l.request}};(0,t.useEffect)((()=>{decodeURIComponent(Ce);const s=te.findIndex((e=>e.url===Ce));console.log(s,_e,"lll"),-1!==s?(Qe(U,Ce,s),e(`/previewimages/${_e}`,{replace:!0})):console.log("Image not found in mediaImages")}),[_e,Ce,te,fe,U]);const $e=(e,s)=>{ee(e),G(s),X(!0)},{t:Te}=(0,p.Bd)();(0,t.useEffect)((()=>{const e=localStorage.getItem("language")||"en";g.A.language!==e&&g.A.changeLanguage(e)}),[g.A,Te]);const Le=async e=>{ue(e),D(!0),Y("Are you sure? You want delete this")},Fe=async e=>{const s=localStorage.getItem("userLogin"),t=s?JSON.parse(s):null;let l={id:_e,user_id:t.id,coverphoto:e};try{await u.A.post(Ee+"setCoverphoto",l,{headers:{Accept:"application/json","Content-Type":"application/json"}});Ye(!1),a(!0),b("Cover photo has been set successfully."),Oe(_e),setTimeout((()=>{a(!1)}),800)}catch(o){o.response?console.error("Server Response Error:",o.response.data):o.request?console.error("No Response Received:",o.request):console.error("Request Error:",o.message)}},qe=async e=>{O(!0);const s=localStorage.getItem("userLogin"),a=s?JSON.parse(s):null;let t={id:_e,user_id:a.id};C(e);try{const e=await u.A.post(Ee+"getmediaAlbumName",t,{headers:{Accept:"application/json","Content-Type":"application/json"}});R(e.data.results)}catch(l){l.response?console.error("Server Response Error:",l.response.data):l.request?console.error("No Response Received:",l.request):console.error("Request Error:",l.message)}},Je=()=>{de(!1),O(!1)},Ue=(0,t.useRef)(null),Me=e=>new Promise(((s,a)=>{const t=new FileReader;t.onload=t=>{const l=new Image;l.onload=()=>{const t=document.createElement("canvas");t.width=l.width,t.height=l.height;t.getContext("2d").drawImage(l,0,0),t.toBlob((t=>{if(t){const a=new File([t],e.name.replace(/\.\w+$/,".png"),{type:"image/png",lastModified:Date.now()});s(a)}else a(new Error("Conversion failed."))}),"image/png",1)},l.onerror=a,l.src=t.target.result},t.onerror=a,t.readAsDataURL(e)})),[Be,Ye]=(0,t.useState)(!1),Pe=e=>{Ye(Be===e?null:e)},[De,Ke]=(0,t.useState)(null),[ze,He]=(0,t.useState)(null),[We,Ve]=(0,t.useState)(!1),[Xe,Ze]=(0,t.useState)([]),Ge=()=>{Ve(!0),document.body.style.overflowY="hidden"},Qe=async(e,s,a)=>{be(e),we(s),ke(a);const t=localStorage.getItem("userLogin");t&&JSON.parse(t);let l={file:s,id:e,user_id:fe};console.log(l);try{const a=(await u.A.post(Ee+"getuseralbumFile",l,{headers:{Accept:"application/json","Content-Type":"application/json"}})).data;console.log(a),!0===a.matched&&(Ke(a.results),He(s),es(s,e),Ge())}catch(o){}},es=async(e,s)=>{const a=localStorage.getItem("userLogin");a&&JSON.parse(a);let t={file:e,id:s,user_id:fe};try{const e=(await u.A.post(Ee+"getUseralbumsComments",t,{headers:{Accept:"application/json","Content-Type":"application/json"}})).data;console.log(e.album),Ze(e.album.comments)}catch(l){}};return console.log(te),(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)(n.A,{}),s&&(0,y.jsx)(c.A,{message:N}),(0,y.jsx)(h.M,{isOpen1:P,onClose1:()=>{D(!1)},message:B,onReturnSent:async()=>{(async()=>{const e=localStorage.getItem("userLogin");let s={user_id:(e?JSON.parse(e):null).id,image:me,id:U};try{(await u.A.post(Ee+"privatealbumdelete",s,{headers:{Accept:"application/json","Content-Type":"application/json"}})).data,Ye(!1),D(!1),Oe(_e)}catch(a){}})()}}),(0,y.jsx)("section",{className:"ggboxes d-block gapy",children:(0,y.jsxs)("div",{className:"container-lg",children:[(0,y.jsxs)("div",{className:"row gy-4 mb-5",children:[(0,y.jsxs)("div",{className:"col-md-6",children:[(0,y.jsx)("h2",{className:"pagetitle",children:`${Te("Photos")}`}),(0,y.jsxs)("strong",{children:["(",pe,")"]})]}),(0,y.jsx)("div",{className:"col-md-6",children:(0,y.jsx)("div",{className:"d-flex justify-content-md-end"})})]}),(0,y.jsx)("div",{className:"row",children:(0,y.jsx)("div",{className:"col-12",children:(0,y.jsxs)(r.tU,{children:[(0,y.jsx)(r.wb,{children:(0,y.jsxs)("div",{className:"d-flex align-items-center justify-content-between w-100",children:[(0,y.jsxs)("div",{className:"d-flex align-items-center gap-2",children:[(0,y.jsx)(r.oz,{children:`${Te("Media")}`}),(0,y.jsx)("button",{type:"button",onClick:()=>e(`/friend/${fe}`),className:"btn backbtn",children:"Back"})]}),Re.id===fe&&(0,y.jsx)("button",{className:"react-tabs__tab react-tabs__tab--selected",type:"button",onClick:()=>{de(!0)},children:Te("Upload")})]})}),(0,y.jsx)(r.Kp,{children:(0,y.jsx)("div",{className:"row gy-4",children:te.length>0?te.map(((e,s)=>(0,y.jsx)("div",{className:"col-md-3",children:(0,y.jsx)("div",{className:"d-flex flex-column gap-2",children:(0,y.jsxs)("div",{className:"ggimagebox ofit position-relative",children:[(0,y.jsx)(v.A,{className:"hover-shadow",url:e.url,onClick:()=>Qe(e.id,e.url,s)}),e.url===e.cover_image&&(0,y.jsx)(y.Fragment,{children:Re.id===fe&&(0,y.jsx)("div",{className:"d-flex flex-column gap-3 image_center_ w-100",children:(0,y.jsxs)("div",{style:{position:"relative",display:"inline-block"},className:"d-flex justify-content-between align-items-center gap-3 w-100",children:[e.url===e.cover_image&&(0,y.jsx)("button",{className:"py-1",type:"button",title:Te("Cover_photo"),children:(0,y.jsx)(f.A,{})}),(0,y.jsx)("button",{className:"remove_mess",onClick:()=>Pe(s),children:(0,y.jsx)(x.Kak,{})}),Be===s&&(0,y.jsxs)("ul",{className:"popup-menu w-fit",children:[(0,y.jsx)("li",{onClick:()=>Le(e.url),children:Te("delete")}),(0,y.jsx)("li",{onClick:()=>qe(e.url),children:Te("MOve_to")}),(0,y.jsx)("li",{onClick:()=>Fe(e.url),children:Te("Cover_photo")})]})]})})}),e.url!=e.cover_image&&(0,y.jsx)(y.Fragment,{children:Re.id===fe&&(0,y.jsx)("div",{className:"d-flex flex-column gap-3 image_center_ w-100",children:(0,y.jsxs)("div",{style:{position:"relative",display:"inline-block"},className:"d-flex justify-content-end align-items-end gap-3 w-100",children:[(0,y.jsx)("button",{className:"remove_mess",onClick:()=>Pe(s),children:(0,y.jsx)(x.Kak,{})}),Be===s&&(0,y.jsxs)("ul",{className:"popup-menu w-fit",children:[(0,y.jsx)("li",{onClick:()=>Le(e.url),children:Te("delete")}),(0,y.jsx)("li",{onClick:()=>qe(e.url),children:Te("MOve_to")}),(0,y.jsx)("li",{onClick:()=>Fe(e.url),children:Te("Cover_photo")})]})]})})})]})})},s))):(0,y.jsxs)("p",{children:[`${Te("No_avalibale_media")}`,"."]})})}),(0,y.jsx)(r.Kp,{children:(0,y.jsxs)("div",{className:"row gy-4",children:[!K&&se.length>0?se.map(((e,s)=>(0,y.jsx)("div",{className:"col-md-3",children:(0,y.jsx)("div",{className:"d-flex flex-column gap-2",children:(0,y.jsxs)("div",{className:"ggimagebox ofit",children:[(0,y.jsx)("img",{src:e.img,alt:"Media",onClick:()=>(async e=>{let s={album_id:e};try{const e=await u.A.post(Ee+"getallmediaa",s,{headers:{Accept:"application/json","Content-Type":"application/json"}});if(e&&e.data&&e.data.results){const s=e.data.results.map((e=>{let s=[];if(e.images&&"undefined"!==e.images&&""!==e.images)try{s=JSON.parse(e.images)}catch(a){console.error("Error parsing images for item:",e.id,a),s=[]}return{mediaItems:s.filter((e=>e.match(/\.(jpeg|jpg|png|gif|webp)$/i)||e.match(/\.(mp4|mov|avi|mkv|webm|ogg|flv|3gp|mkv|webm)$/i)))}}));z(!0),W(s)}}catch(a){a.response?console.error("Server Response Error:",a.response.data):a.request?console.error("No Response Received:",a.request):console.error("Request Error:",a.message)}})(e.album_id),className:"hover-shadow"}),(0,y.jsxs)("span",{children:[e.album_name," (",e.media_count,")"]})]})})},s))):!K&&(0,y.jsxs)("p",{children:[`${Te("No_avalibale_media")}`,"."]}),K&&(H.length>0?H.map(((e,s)=>e.mediaItems.length>0?e.mediaItems.map(((a,t)=>(0,y.jsx)("div",{className:"col-md-3",children:(0,y.jsx)("div",{className:"d-flex flex-column gap-2",children:(0,y.jsx)("div",{className:"ggimagebox ofit",children:a.match(/\.(mp4|mov|avi|mkv|webm|ogg|flv|3gp|mkv|webm)$/i)?(0,y.jsxs)("video",{controls:!0,onClick:()=>$e(e.mediaItems,t),className:"hover-shadow",children:[(0,y.jsx)("source",{src:a,type:"video/mp4"}),`${Te("Your_browser_does")}`]}):(0,y.jsx)("img",{src:a,alt:"Media",onClick:()=>$e(e.mediaItems,t),className:"hover-shadow"})})})},`${s}-${t}`))):(0,y.jsxs)("p",{children:[`${Te("No_avalibale_media")}`,"."]}))):(0,y.jsxs)("p",{children:[`${Te("No_avalibale_media")}`,"."]}))]})})]})})})]})}),V&&(0,y.jsxs)("div",{id:"myModal",className:"modalgg",children:[(0,y.jsx)("span",{className:"close cursor",onClick:()=>X(!1),children:"\xd7"}),(0,y.jsxs)("div",{className:"modal-content",children:[Q.length>0?Q.map(((e,s)=>(0,y.jsxs)("div",{className:"mySlides",style:{display:Z===s?"block":"none"},children:[(0,y.jsxs)("div",{className:"numbertext",children:[s+1," / ",Q.length]}),e.match(/\.(jpeg|jpg|gif|png|webp|bmp|svg)$/i)?(0,y.jsx)("img",{src:e,alt:"img"}):e.match(/\.(mp4|mov|avi|mkv|webm|ogg|flv|3gp)$/i)?(0,y.jsxs)("video",{controls:!0,children:[(0,y.jsx)("source",{src:e,type:"video/mp4"}),Te("Your_browser_does")]}):null]},s))):(0,y.jsx)("p",{children:Te("Noresult")}),(0,y.jsx)("a",{className:"prev",onClick:()=>G((e=>0===e?Q.length-1:e-1)),children:"\u276e"}),(0,y.jsx)("a",{className:"next",onClick:()=>G((e=>e===Q.length-1?0:e+1)),children:"\u276f"})]})]}),(0,y.jsxs)(d.A,{show:ce,className:"edit_admin",onHide:Je,children:[(0,y.jsx)(d.A.Header,{closeButton:!0,children:(0,y.jsx)(d.A.Title,{className:"textcolor",children:Te("Upload")})}),(0,y.jsx)(d.A.Body,{children:(0,y.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),!je)return void alert("Please select images to upload.");F(!1),T(!0);const s=localStorage.getItem("userLogin"),a=s?JSON.parse(s):null,t=new FormData;console.log(je),je.forEach((e=>{t.append("images",e)})),t.append("id",U),t.append("user_id",a.id),t.append("fileType","");try{var l=(await u.A.post(Ee+"uploadprivateAlbums",t,{headers:{Accept:"application/json","Content-Type":"multipart/form-data"}})).data;J(l.message),setTimeout((()=>{F(!0),T(!1),de(!1),ve(null),Oe(_e),J("")}),3500)}catch(o){o.response||(o.request?console.error("Request data:",o.request):console.error("Error message:",o.message))}},children:[(0,y.jsx)("div",{className:"mb-3",children:(0,y.jsxs)("div",{className:"uploadfile rel bgload",children:[(0,y.jsx)("p",{className:"pb-2 text-dark",children:Te("select_one_more")}),(0,y.jsx)("input",{type:"file",name:"file",required:!0,accept:"image/*,video/mp4,video/webm,video/ogg",multiple:!0,onChange:async e=>{const s=e.target.files;let a=[],t="";if(s.length>10)t="You can only upload a maximum of 10 files.";else for(const o of s){const e=o.type;if(!e.startsWith("image/")&&!e.startsWith("video/")){t=`File "${o.name}" is not an image or video.`;break}if(o.size>52428800){t=`File "${o.name}" exceeds the 5 MB limit.`;break}if(e.startsWith("image/")&&!["image/jpeg","image/png","image/gif"].includes(e))try{const e=await Me(o);a.push(e)}catch(l){console.error(`Error converting ${o.name}:`,l),t=`Failed to convert image "${o.name}".`;break}else a.push(o)}t?xe(t):(xe(""),ve(a))},className:"fileload",ref:Ue}),he&&(0,y.jsx)("p",{style:{color:"red"},children:he}),(0,y.jsx)("div",{className:"inload",style:{height:"50px"},children:(0,y.jsxs)("div",{className:"d-flex gap-3 align-items-center",children:[null!==je&&(0,y.jsx)(y.Fragment,{children:je.map(((e,s)=>(0,y.jsxs)("div",{className:"upimage rel",children:[(0,y.jsx)("button",{type:"button",className:"preremovBtn",onClick:()=>(e=>{ve((s=>{const a=s.filter(((s,a)=>a!==e));return 0===a.length&&Ue.current&&(Ue.current.value=""),a}))})(s),children:"X"}),(0,y.jsx)("div",{className:"inimag ofit",children:e.type.startsWith("image/")?(0,y.jsx)("img",{src:URL.createObjectURL(e),alt:e.name}):(0,y.jsx)("video",{width:"160",height:"120",controls:!0,children:(0,y.jsx)("source",{src:URL.createObjectURL(e),type:e.type})})})]},s)))}),(0,y.jsxs)("div",{className:"d-flex align-items-center gap-2",children:[(0,y.jsx)(l.Kh2,{style:{fontSize:"24px"}}),(0,y.jsxs)("h3",{className:"m-0 text-dark",style:{fontSize:"14px"},children:[Te("upload_image"),"/",Te("Videos")]})]})]})})]})}),(0,y.jsx)("span",{className:"text-success",children:q}),$&&(0,y.jsx)("div",{className:"spinner-border text-success send_load",role:"status",children:(0,y.jsxs)("span",{className:"visually-hidden",children:[Te("loading"),"..."]})}),(0,y.jsxs)(d.A.Footer,{children:[(0,y.jsx)(m.A,{variant:"secondary",onClick:Je,children:Te("Close")}),(0,y.jsx)(m.A,{type:"submit",style:{background:"#6e75a8",opacity:L?1:.1,pointerEvents:L?"auto":"none"},className:"",children:Te("Upload")})]})]})})]}),(0,y.jsxs)(d.A,{show:E,className:"edit_admin",onHide:Je,children:[(0,y.jsx)(d.A.Header,{closeButton:!0,children:(0,y.jsxs)(d.A.Title,{className:"textcolor",children:[" ",Te("Upload")]})}),(0,y.jsx)(d.A.Body,{children:(0,y.jsxs)("form",{onSubmit:async()=>{const e=localStorage.getItem("userLogin"),s=e?JSON.parse(e):null;let t={file:_,id:S,removeid:U,user_id:s.id};try{await u.A.post(Ee+"movetoFile",t,{headers:{Accept:"application/json","Content-Type":"application/json"}});w(""),O(!1),setTimeout((()=>{a(!0)}),80),b("Successfully moved"),Oe(_e),setTimeout((()=>{a(!1)}),800)}catch(l){}},method:"post",action:"javascript:void(0)",children:[(0,y.jsxs)("div",{className:"row g-3",children:[" ",(0,y.jsxs)("div",{className:"col-md-12",children:[(0,y.jsxs)("label",{className:"stextlabel text-dark",children:[Te("AlbumNameFrom")," "]}),(0,y.jsx)("input",{type:"text",disabled:!0,name:"album_name",value:A,className:"form-control",required:!0})]}),(0,y.jsxs)("div",{className:"col-md-12",children:[(0,y.jsxs)("label",{className:"stextlabel text-dark",children:[Te("MOve_to")," *"]}),(0,y.jsxs)("select",{required:!0,className:"form-control",onChange:e=>{w(e.target.value)},name:"move_to",children:[(0,y.jsx)("option",{value:"",children:"--Select--"}),I.map(((e,s)=>(0,y.jsx)("option",{value:e.id,children:e.name},s)))]})]})]}),(0,y.jsx)("span",{className:"text-success",children:q}),$&&(0,y.jsx)("div",{className:"spinner-border text-success send_load",role:"status",children:(0,y.jsxs)("span",{className:"visually-hidden",children:[Te("loading"),"..."]})}),(0,y.jsxs)(d.A.Footer,{children:[(0,y.jsx)(m.A,{variant:"secondary",onClick:Je,children:Te("Close")}),(0,y.jsx)(m.A,{type:"submit",style:{background:"#6e75a8"},className:"",children:Te("Move")})]})]})})]}),(0,y.jsx)(i.w,{}),(0,y.jsx)(j.E,{isOpen1:We,onClose1:()=>{Ve(!1),document.body.style.overflowY="auto"},PopupData:De,PopupDatafile:ze,UserPhotoCommetss:Xe,UserAlbumId:Ne,getfavalbum:async()=>{const e=localStorage.getItem("userLogin");e&&JSON.parse(e);let s={file:Se,id:Ne,user_id:fe};console.log(s);try{const e=(await u.A.post(Ee+"getuseralbumFile",s,{headers:{Accept:"application/json","Content-Type":"application/json"}})).data;!0===e.matched&&(Ke(e.results),He(Se),es(Se,Ne),Ge())}catch(a){}},goToNext:()=>{if(Ae<te.length-1){const e=Ae+1,s=te[e];ke(e),Qe(s.id,s.url,e)}},goToPrevious:()=>{if(Ae>0){const e=Ae-1,s=te[e];ke(e),Qe(s.id,s.url,e)}},mediaImages:te,currentIndex:Ae,setCurrentIndex:ke,openModalLikeComment:Qe,refreshpost:()=>{window.location.reload()},getfavrefresh:async()=>{const e=localStorage.getItem("userLogin");e&&JSON.parse(e);let s={file:Se,id:Ne,user_id:fe};console.log(s);try{const e=(await u.A.post(Ee+"getuseralbumFile",s,{headers:{Accept:"application/json","Content-Type":"application/json"}})).data;console.log(e),!0===e.matched&&(Ge(),Ke(e.results),He(Se),es(Se,Ne))}catch(a){}}})]})}}}]);
//# sourceMappingURL=9980.5e991fe6.chunk.js.map